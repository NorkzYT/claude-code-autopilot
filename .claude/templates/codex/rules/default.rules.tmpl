# Guardrails for {{DISPLAY_NAME}} (Codex)
# AUTO-GENERATED by add_openclaw_agent.sh

# Risky/destructive commands require explicit approval.
prefix_rule(
    pattern=["rm"],
    decision="prompt",
    justification="Destructive filesystem command",
)

prefix_rule(
    pattern=["sudo"],
    decision="prompt",
    justification="Privilege escalation",
)

prefix_rule(
    pattern=["shred"],
    decision="forbidden",
    justification="Secure-delete command is blocked",
)

prefix_rule(
    pattern=["dd"],
    decision="prompt",
    justification="Low-level disk/file write command",
)

# Git safety policy.
prefix_rule(
    pattern=["git", "push", "--force"],
    decision="forbidden",
    justification="Force push is blocked",
)

prefix_rule(
    pattern=["git", "push", "-f"],
    decision="forbidden",
    justification="Force push is blocked",
)

prefix_rule(
    pattern=["git", "push", "origin", "main"],
    decision="forbidden",
    justification="Push to main is blocked",
)

prefix_rule(
    pattern=["git", "push", "origin", "master"],
    decision="forbidden",
    justification="Push to master is blocked",
)

